<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Delta (git.Git__Store.Make.Pack.PEnc.Delta)</title><link rel="stylesheet" href="../../../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../../../../index.html">git</a> &#x00BB; <a href="../../../../index.html">Git__Store</a> &#x00BB; <a href="../../../index.html">Make</a> &#x00BB; <a href="../../index.html">Pack</a> &#x00BB; <a href="../index.html">PEnc</a> &#x00BB; Delta</nav><h1>Module <code>PEnc.Delta</code></h1></header><div class="spec module" id="module-Hash"><a href="#module-Hash" class="anchor"></a><code><span class="keyword">module</span> <a href="Hash/index.html">Hash</a> : <a href="../../../../../Git__/S/index.html#module-type-HASH">Git__.S.HASH</a></code></div><div class="spec module" id="module-Entry"><a href="#module-Entry" class="anchor"></a><code><span class="keyword">module</span> <a href="Entry/index.html">Entry</a> : <a href="../../../../../Git/Pack/index.html#module-type-ENTRY">Git.Pack.ENTRY</a> <span class="keyword">with</span> <span class="keyword">module</span> <a href="../../../../../Git/Pack/module-type-ENTRY/Hash/index.html">Hash</a> := <a href="index.html#module-Hash">Hash</a></code></div><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = </code><code>{</code><table class="record"><tr id="type-t.delta" class="anchored"><td class="def field"><a href="#type-t.delta" class="anchor"></a><code><span class="keyword">mutable</span> delta : <a href="index.html#type-delta">delta</a>;</code></td></tr></table><code>}</code></dt><dd><p>The type of the delta-ification.</p></dd></dl><dl><dt class="spec type" id="type-delta"><a href="#type-delta" class="anchor"></a><code><span class="keyword">and</span> delta</code><code> = </code><table class="variant"><tr id="type-delta.Z" class="anchored"><td class="def constructor"><a href="#type-delta.Z" class="anchor"></a><code>| </code><code><span class="constructor">Z</span></code></td><td class="doc"><p>Means no delta-ification.</p></td></tr><tr id="type-delta.S" class="anchored"><td class="def constructor"><a href="#type-delta.S" class="anchor"></a><code>| </code><code><span class="constructor">S</span> <span class="keyword">of</span> </code><code>{</code><table class="record"><tr id="type-delta.length" class="anchored"><td class="def field"><a href="#type-delta.length" class="anchor"></a><code>length : int;</code></td><td class="doc"><p>Length of the PACK object.</p></td></tr><tr id="type-delta.depth" class="anchored"><td class="def field"><a href="#type-delta.depth" class="anchor"></a><code>depth : int;</code></td><td class="doc"><p>Depth of the PACK object.</p></td></tr><tr id="type-delta.hunks" class="anchored"><td class="def field"><a href="#type-delta.hunks" class="anchor"></a><code>hunks : <span>Duff.t list</span>;</code></td><td class="doc"><p>Compression list.</p></td></tr><tr id="type-delta.src" class="anchored"><td class="def field"><a href="#type-delta.src" class="anchor"></a><code>src : <a href="index.html#type-t">t</a>;</code></td><td class="doc"><p>Source.</p></td></tr><tr id="type-delta.src_length" class="anchored"><td class="def field"><a href="#type-delta.src_length" class="anchor"></a><code>src_length : int64;</code></td><td class="doc"><p>Length of the source object.</p></td></tr><tr id="type-delta.src_hash" class="anchored"><td class="def field"><a href="#type-delta.src_hash" class="anchor"></a><code>src_hash : <a href="index.html#module-Hash">Hash</a>.t;</code></td><td class="doc"><p>Hash of the source object.</p></td></tr></table><code>}</code></td><td class="doc"><p>Delta-ification with a description of the source.</p></td></tr></table></dt><dt class="spec type" id="type-error"><a href="#type-error" class="anchor"></a><code><span class="keyword">type</span> error</code><code> = </code><table class="variant"><tr id="type-error.Invalid_hash" class="anchored"><td class="def constructor"><a href="#type-error.Invalid_hash" class="anchor"></a><code>| </code><code><span class="constructor">Invalid_hash</span> <span class="keyword">of</span> <a href="index.html#module-Hash">Hash</a>.t</code></td><td class="doc"><p>Appears when we have an invalid hash.</p></td></tr></table></dt><dd><p>The type of error.</p></dd></dl><dl><dt class="spec value" id="val-pp_error"><a href="#val-pp_error" class="anchor"></a><code><span class="keyword">val</span> pp_error : <span><a href="index.html#type-error">error</a> Fmt.t</span></code></dt><dd><p>Pretty-printer for <a href="index.html#type-error"><code>error</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-deltas"><a href="#val-deltas" class="anchor"></a><code><span class="keyword">val</span> deltas : <span>?&#8288;memory:bool</span> <span>&#45;&gt;</span> <span><a href="Entry/index.html#type-t">Entry.t</a> list</span> <span>&#45;&gt;</span> <span>(<a href="index.html#module-Hash">Hash</a>.t <span>&#45;&gt;</span> <span><span>Cstruct.t option</span> Lwt.t</span>)</span> <span>&#45;&gt;</span> <span>(<a href="Entry/index.html#type-t">Entry.t</a> <span>&#45;&gt;</span> bool)</span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span><span><span>(<span><span>(<a href="Entry/index.html#type-t">Entry.t</a> * <a href="index.html#type-t">t</a>)</span> list</span>, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span> Lwt.t</span></code></dt><dd><p><code>deltas ?memory lst getter tagger window depth</code>.</p><p>This is the main algorithm about the serialization of the git object in a PACK file. The purpose is to order and delta-ify entries.</p><p><code>getter</code> is a function to access to the real inflated raw of the git object requested by the hash. This function must allocate the raw (or let the ownership to this function). The algorithm takes the ownership anyway.</p><p><code>tagger</code> is a function to annotate an entry as preferred to serialize firstly.</p><p><code>window</code> corresponds to the number of how many object(s) we keep for the delta-ification or, if <code>memory</code> is <code>true</code>, how many byte(s) we keep for the delta-ification. The client can control the memory consumption of this algorithm precisely if he wants.</p><p><code>depth</code> is the maximum of the delta-ification allowed.</p><p>If you want to understand the algorithm, look the source code.</p></dd></dl></div></body></html>